var messages=[];var socket;var tabActive=false;function renderChat(e,b){if(e===""){return}var a="Anonymous";var c='  <div class="row well"><div class="col-sm-2">  <span>Anonymous</span><img src="./images/manager.png" class="img-circle" style="height:80px; width:80px;"> </div> <div><br> <strong>'+e+"</strong><br></div></div>";if(b=="right"){c='  <div class="row well"> <div class="col-sm-6 col-md-offset-4" style="text-align:right;"><br> <strong>'+e+'</strong><br></div><div class="col-sm-2">  <img src="./images/employee.png" class="img-circle" style="height:80px; width:80px;"> <span>You</span> </div></div>'}else{if(tabActive===false){c+='<audio src="./sound/ping.mp3" autoplay></audio>'}}$("#cid").append(c);$("html, body").animate({scrollTop:$(document).height()},1000)}function sendToServer(){var b=$("#msg").val();b=b.trim();if(b===""){return}renderChat(b,"right");socket.emit("send",{message:encodeURIComponent(b)});$("#msg").val("")}function sendMsg(a){if(a.keyCode==13){sendToServer()}}$(window).blur(function(){tabActive=false});$(window).focus(function(){tabActive=true});(function(){$("#myModal").modal({keyboard:false});messages=[];socket=io.connect();$("#myModal").modal("hide");$("#app").show();socket.on("message",function(a){if(a.message){messages.push(a.message);renderChat(decodeURIComponent(a.message),"left")}else{console.log("There is a problem:",a)}});socket.on("gone",function(a){location.reload()});$("#send").on("click",function(){sendToServer()})}());